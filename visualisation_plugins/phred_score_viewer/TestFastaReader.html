<html>
	<head>
		<script type="text/javascript" src="Biojs.js"></script>
        <script type="text/javascript" src="Biojs.FastaReader.js"></script>        
        <script type="text/javascript" src="jquery-1.9.1.min.js"></script>
        <script type="text/javascript">
			var instance;
			var fastaSize;
			var sizeRequest;
			function fastaParser(fasta){
				
				readLines = [];
					var currentLine = splitFasta.shift();
					
					while(currentLine!="" && currentLine!=null && currentLine!=undefined)
					{
						//alert(currentLine.charAt(0));
						if (currentLine.charAt(0)==">"){
							identifier = currentLine.substring(1,currentLine.length-1);					
							currentLine = splitFasta.shift();
						}
						
						if (currentLine.charAt(0) != "#"){						
						readLines.push(currentLine)						
					}
					currentLine = splitFasta.shift();
						
							
					}
					
					console.log(readLines);
				}
				
			
			function getFileSize() {	
				//var request;			
				sizeRequest = $.ajax({
					type: "HEAD", 
					url: "chr2.fa", 
					async: true,
					success: function() {
						
						fastaSize = sizeRequest.getResponseHeader("Content-Length");
						main(fastaSize);
					},
					error: function(){
						alert("error reading fasta size");
					},
				
				});
				return fastaSize;
			};
			
			function getSequence(startByte, endByte){
				if (endByte<startByte || endByte<fastaSize){
					var request;
					bytes = startByte + "-" + endByte;
					request = $.ajax({
						url: "chr2.fa",
						async: false,
						beforeSend : function(xhr) {
							xhr.setRequestHeader("Range", "bytes=" + bytes );
						},
						success: function(data){
							//alert(data);
							$("#fasta").append(data);
							return data;
						},
						error: function(data){
							alert("Error fetching data");
						},
					});
				}
				else{
					alert("Startbytes should not be > end");
				}
			}
			
			function main(fastaSize){
				//alert(fastaSize);
				//$("#fasta").append("dsdasddddddddddddddddddddddddddddddd");
				//$("#fasta").append("dsdasddddddddddddddddddddddddddddddd");
				if (fastaSize<5000){
					var seq =  getSequence(0,fastaSize);
					$("#fasta").append(seq);
				}
				var chunks = fastaSize/5000.0;
				//alert(chunks);
				for (var i=0;i<chunks; i++){
					var start = i*5000;
					var end = start+4999;
					var seq = getSequence(start, end);
					
					
				}
				
				
			}
				
			
			
			window.onload = function (){
				fastaSize = getFileSize();
			}
			
        </script>
        <body><div id="fasta"></div></body>
        
</html>
